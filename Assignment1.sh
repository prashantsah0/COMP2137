#!/bin/bash

#COMP2137 Linux Automation
#DATE Feb 12-13, 2025
#Prof. Dennis simpson
#Script prepared by Prashant Kumar Sah


#To get the logged in user information
USER=$(whoami)

#Getting System Information

#To generate hostname
HOSTNAME=$(hostname)

#To get the OS Information
OS=$(source /etc/os-release && echo $NAME && echo $VERSION)

#To get the system uptime
UPTIME=$(uptime -p)

#Getting Hardware Information

#To get the cpu processor make and model information
CPU_INFORMATION=$(cat /proc/cpuinfo | grep "model name" | head -n 1 | sed 's/.*: //')

#To get the size of installed RAM
RAM=$(grep MemTotal /proc/meminfo | awk '{printf "%.1fGi\n", $2/1024/1024}')

#To get the make and model and size for all installed disks
DISKS=$(sudo lshw -class disk -short | awk '/disk/ {printf "Make: %s Model: %s Size: %s\n", $3, $4, $5}')

#Getting the make and model of video card
VIDEO_CARD=$(lspci | grep -i vga | awk '{$1="";$2=""; print $0}')

#Collecting Network Information 

#To get the fully qualified domain name
FQDN=$(hostname -f)

#To get the host ip address for the interface that is connected to the default gateway
HOST_ADDRESS=$(hostname -I)

#Getting default gateway address
GATEWAY_IP=$(ip route | grep default | awk '{print $3}')

#To get the DNS server
DNS_SERVER=$(grep nameserver /etc/resolv.conf | awk '{print $2}')

#Collecting system Status

#To get the logged in users
USERS=$(who | awk '{print $1}' | paste -sd, -)

#To get the free disk space information
DISK_SPACE=$(df -h --output=target,avail | grep -E '^/dev' | awk '{print $1, $2}')

#To get the count of total number of running processes
PROCESS_COUNT=$( ps -e | tail -n +2 | wc -l)

#To get the load averages
LOAD_AVERAGES=$(uptime | awk '{print $10 "," $11 "," $12}')

#To get the total number of listening networks ports
LISTENING_NETWORK_PORT=$(sudo netstat -tuln | awk 'NR > 2 {print $4}' | cut -d: -f2 | tr '\n' ',' | sed 's/,$/\n/')

#To check the UFW status whether it is enabled or disabled
UFW_STATUS=$(sudo ufw status | awk 'NR==1 {print $2}')


#The output report directly to the terminal
cat <<EOF


System Report generated by $USER,$(date)

System Information
------------------
Hostname: $HOSTNAME
      OS: $OS
  Uptime: $UPTIME

Hardware Information
--------------------
    Cpu: $CPU_INFORMATION
    Ram: $RAM
Disk(s):$DISKS
Video: $VIDEO_CARD

Network Information
-------------------
FQDN: $FQDN
Host Address: $HOST_ADDRESS 
Gateway IP: $GATEWAY_IP 
DNS Server: $DNS_SERVER

System Status
--------------
Users Logged In: $USERS
Disk Space: $DISK_SPACE
Process Count: $PROCESS_COUNT
Load Averages: $LOAD_AVERAGES
Listening Network Ports: $LISTENING_NETWORK_PORTS
UFW STATUS: $UFW_STATUS



EOF
